webpackJsonp([2,3],{107:function(t,e){},108:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var a=n(1),r=i(a),o=n(11),u=i(o),s=n(112),c=i(s),l=n(23),d=i(l),f=new u.default((0,r.default)({store:d.default},c.default));f.$mount("#app")},112:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),r=i(a);n(125),n(50);var o=n(5),u=n(22),s=i(u),c=n(14),l=i(c);e.default={computed:(0,r.default)({},(0,o.mapGetters)({global:"getGlobal"})),data:function(){return{form:{username:"",password:"",remember_me:""}}},methods:{handleAddUser:function(){var t=this;l.default.addUser().then(function(){t.$store.dispatch("showMsg",{content:"用户名: admin1, 密码: 123456",type:"success"})},function(e){t.$store.dispatch("showMsg",e.toString())})},handleChange:function(t,e){this.form[t]=e.target.value},handleSubmit:function(t){var e=this;return t.preventDefault(),""===this.form.username||""===this.form.password?(this.$store.dispatch("showMsg","请输入用户名和密码"),!1):void l.default.login({username:this.form.username,password:this.form.password}).then(function(t){e.$store.dispatch("showMsg",{content:"登录成功",type:"success"}),s.default.set("token",t.id),setTimeout(function(){window.location.href="/admin/post"},1e3)},function(t){e.$store.dispatch("showMsg",t.toString())})}},render:function(t){return t("section",{class:"container"},[t("div",{class:"login"},[t("h1",null,["后台管理"]),t("form",{attrs:{id:"shake-setting",action:"#",method:"post"},on:{submit:this.handleSubmit}},[t("p",null,[t("input",{on:{change:this.handleChange.bind(this,"username")},attrs:{type:"text",name:"username",value:"",placeholder:"请输入用户名"}},[])]),t("p",null,[t("input",{on:{change:this.handleChange.bind(this,"password")},attrs:{type:"password",name:"password",value:"",placeholder:"请输入密码"}},[])]),t("p",{class:"remember_me"},[t("label",null,[t("input",{on:{change:this.handleChange.bind(this,"remember_me")},attrs:{value:"on",type:"checkbox",name:"remember_me",id:"remember_me"}},[]),"保持登录"])]),t("p",{class:"submit"},[t("input",{attrs:{type:"submit",value:"登录"}},[])]),t("p",{class:"submit"},[t("input",{on:{click:this.handleAddUser},attrs:{type:"button",value:"添加用户"}},[])])])])])}}},125:function(t,e){},14:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),r=i(a),o=n(51),u=i(o),s=n(23),c=i(s),l=n(103),d=i(l),f="M1SivUjmGWHTFDv6FpwYxTpl-gzGzoHsz",p="OwVDXgMCR09ztWdUIYGqG5Hl";d.default.init({appId:f,appKey:p}),e.default={addUser:function(){var t=new d.default.User;return t.setUsername("admin1"),t.setPassword("123456"),t.setEmail("admin1@mmxiaowu.com"),t.signUp()},login:function(t){return d.default.User.logIn(t.username,t.password)},postTopic:function(t){var e=d.default.Object.extend("article"),n=new e;for(var i in t)n.set(i,t[i]);return n.set("is_delete",0),n.set("visit",0),n.save()},getTopics:function(t){var e=new d.default.Query("article");return 0===t.admin&&e.equalTo("is_delete",0),t.qs&&e.contains("title",t.qs),t.id&&e.equalTo("category",t.id),e.descending("createdAt"),e.limit(t.limit),e.skip((t.page-1)*t.limit),u.default.all([e.count(),e.find()]).then(function(e){return c.default.dispatch("gProgress",100),{list:e[1].map(function(t){return{_id:t.get("id"),title:t.get("title"),category:t.get("category"),content:t.get("content"),visit:t.get("visit"),is_delete:t.get("is_delete"),creat_date:t.get("createdAt")}}),total:e[0],hasNext:e[0]>t.page*t.limit,hasPrev:t.page>1}},function(t){c.default.dispatch("showMsg",t.toString())})},getArticle:function(t){var e=new d.default.Query("article"),n=new d.default.Query("article"),i=new d.default.Query("article");return n.equalTo("is_delete",0),n.ascending("createdAt"),n.limit(1),i.equalTo("is_delete",0),i.descending("createdAt"),i.limit(1),e.get(t.id).then(function(t){var e={_id:t.get("id"),title:t.get("title"),category:t.get("category"),content:t.get("content"),creat_date:t.get("createdAt"),visit:t.get("visit")};return n.greaterThan("createdAt",e.creat_date),i.lessThan("createdAt",e.creat_date),u.default.all([n.first(),i.first()]).then(function(t){c.default.dispatch("gProgress",100);var n={data:e,prev:{},next:{}};return t[0]&&(n.prev={prev_id:t[0].get("id"),prev_title:t[0].get("title")}),t[1]&&(n.next={next_id:t[1].get("id"),next_title:t[1].get("title")}),n},function(t){c.default.dispatch("showMsg",t.toString())})})},getAdminArticle:function(t){var e=new d.default.Query("article");return e.get(t.id).then(function(t){return c.default.dispatch("gProgress",100),{_id:t.get("id"),title:t.get("title"),category:t.get("category"),content:t.get("content")}},function(t){c.default.dispatch("showMsg",t.toString())})},modifyAdminArticle:function(t,e){var n=d.default.Object.createWithoutData("article",t);for(var i in e)n.set(i,e[i]);return n.save().then(function(t){return t},function(t){c.default.dispatch("showMsg",t.toString())})},deleteArticle:function(t){var e=d.default.Object.createWithoutData("article",t.id);return e.set("is_delete",1),e.save().then(function(t){return t},function(t){c.default.dispatch("showMsg",t.toString())})},recoverArticle:function(t){var e=d.default.Object.createWithoutData("article",t.id);return e.set("is_delete",0),e.save().then(function(t){return t},function(t){c.default.dispatch("showMsg",t.toString())})},postComment:function(t){var e=d.default.Object.extend("comment"),n=new e;for(var i in t)n.set(i,t[i]);return n.set("is_delete",0),n.save().then(function(e){return(0,r.default)({},t,{id:e.id})},function(t){c.default.dispatch("showMsg",t.toString())})},getComment:function(t){var e=new d.default.Query("comment");return e.equalTo("article_id",t.id),e.descending("createdAt"),e.limit(t.limit),e.skip((t.page-1)*t.limit),u.default.all([e.count(),e.find()]).then(function(e){return c.default.dispatch("gProgress",100),{list:e[1].map(function(t){return{_id:t.get("id"),username:t.get("username"),content:t.get("content"),is_delete:t.get("is_delete"),creat_date:t.get("createdAt")}}),total:e[0],hasNext:e[0]>t.page*t.limit,hasPrev:t.page>1}},function(t){c.default.dispatch("showMsg",t.toString())})}}},23:function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),o=a(r),u=n(5),s=a(u),c=n(45),l=i(c),d=n(46),f=i(d),p=n(49),m=a(p),g=n(47),_=a(g),h=n(48),E=a(h);o.default.use(s.default),e.default=new s.default.Store({actions:l,getters:f,modules:{topics:m.default,admin:_.default,global:E.default}})},240:function(t,e,n){t.exports=n(108)},45:function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.recoverArticle=e.deleteArticle=e.getAdminArticle=e.getAdminTopics=e.postComment=e.getComment=e.getArticle=e.getTopics=e.hideMsg=e.showMsg=e.gProgress=void 0;var r=n(1),o=a(r),u=n(8),s=i(u),c=n(14),l=a(c),d=n(44),f=a(d);f.default.options.positionClass="toast-top-center";e.gProgress=function(t,e){var n=t.commit;n(s.GLOBAL_PROGRESS,e)},e.showMsg=function(t,e){var n=(t.commit,void 0),i=void 0;"string"==typeof e?(n=e,i="error"):(n=e.content,i=e.type),f.default[i](n)},e.hideMsg=function(){f.default.clear()},e.getTopics=function(t,e){var n=t.commit,i=t.state.route.path;return l.default.getTopics(e).then(function(t){n(s.RECEIVE_TOPICS,(0,o.default)({},e,t,{path:i}))})},e.getArticle=function(t){var e=t.commit,n=t.state.route.params.id;return l.default.getArticle({action:"article",markdown:1,id:n}).then(function(t){e(s.RECEIVE_ARTICLE,(0,o.default)({},t))})},e.getComment=function(t,e){var n=t.commit,i=t.state.route,a=i.path,r=i.params.id,u=e.page,c=e.limit;return l.default.getComment({action:"comment",page:u,id:r,limit:c}).then(function(t){n(s.RECEIVE_COMMENT,(0,o.default)({},t,{page:u,path:a}))})},e.postComment=function(t,e){var n=t.commit,i=t.state.route;i.path,i.params.id;return l.default.postComment(e).then(function(t){return n(s.POST_COMMENT,t),t})},e.getAdminTopics=function(t,e){var n=t.commit,i=t.state.route,a=i.path,r=i.params.page;return e.page=r,l.default.getTopics(e).then(function(t){n(s.RECEIVE_ADMIN_TOPICS,(0,o.default)({},t,{path:a}))})},e.getAdminArticle=function(t){var e=t.state.route.params.id;return l.default.getAdminArticle({action:"getArticle",id:e})},e.deleteArticle=function(t,e){var n=t.commit;l.default.deleteArticle(e).then(function(){n(s.DELETE_ARTICLE,e.id)})},e.recoverArticle=function(t,e){var n=t.commit;l.default.recoverArticle(e).then(function(){n(s.RECOVER_ARTICLE,e.id)})}},46:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.getGlobal=function(t){return t.global},e.getTopics=function(t){return t.topics.topic},e.getArticle=function(t){return t.topics.article},e.getComment=function(t){return t.topics.comment},e.getAdminTopics=function(t){return t.admin.topic},e.getAdminArticle=function(t){return t.admin.article}},47:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a,r=n(16),o=i(r),u=n(8),s={topic:{list:[],path:"",hasNext:0,hasPrev:0},article:{}},c=(a={},(0,o.default)(a,u.RECEIVE_ADMIN_TOPICS,function(t,e){var n=e.list,i=e.path,a=e.hasNext,r=e.hasPrev;t.topic.list=n,t.topic.path=i,t.topic.hasNext=a,t.topic.hasPrev=r}),(0,o.default)(a,u.DELETE_ADMIN_TOPICS_PATH,function(t){t.topic.path=""}),(0,o.default)(a,u.RECEIVE_ADMIN_ARTICLE,function(t,e){var n=e.data;t.article=n}),(0,o.default)(a,u.UPDATE_ADMIN_ARTICLE,function(t,e){var n=t.topic.list.find(function(t){return t._id===e.id});for(var i in n)n.hasOwnProperty(i)&&e[i]&&(n[i]=e[i])}),(0,o.default)(a,u.DELETE_ARTICLE,function(t,e){var n=t.topic.list.find(function(t){return t._id===e});n.is_delete=1}),(0,o.default)(a,u.RECOVER_ARTICLE,function(t,e){var n=t.topic.list.find(function(t){return t._id===e});n.is_delete=0}),a);e.default={state:s,mutations:c}},48:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a,r=n(16),o=i(r),u=n(1),s=i(u),c=n(8),l={loading:!1,progress:0,message:{type:"",content:"",title:""}},d=(a={},(0,o.default)(a,c.GLOBAL_LOADDING,function(t,e){t.loading=e}),(0,o.default)(a,c.GLOBAL_PROGRESS,function(t,e){t.progress=e}),(0,o.default)(a,c.GLOBAL_SHOWMSG,function(t,e){t.message=(0,s.default)({},e)}),(0,o.default)(a,c.GLOBAL_HIDEMSG,function(t){t.message={type:"",content:"",title:""}}),a);e.default={state:l,mutations:d}},49:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a,r=n(16),o=i(r),u=n(8),s={topic:{list:[],hasNext:0,page:1,path:""},article:{data:{},prev:{},next:{}},comment:{list:[],hasNext:0,page:1,path:""}},c=(a={},(0,o.default)(a,u.RECEIVE_TOPICS,function(t,e){var n=e.hasNext,i=e.list,a=e.page,r=e.path;1===a?t.topic.list=[].concat(i):t.topic.list=t.topic.list.concat(i),t.topic.hasNext=n,t.topic.page=a,t.topic.path=r}),(0,o.default)(a,u.RECEIVE_ARTICLE,function(t,e){var n=e.data,i=e.prev,a=e.next;t.article.data=n,t.article.prev=i,t.article.next=a}),(0,o.default)(a,u.RECEIVE_COMMENT,function(t,e){var n=e.hasNext,i=e.list,a=e.path,r=e.page;1===r?t.comment.list=[].concat(i):t.comment.list=t.comment.list.concat(i),t.comment.hasNext=n,t.comment.path=a,t.comment.page=r}),(0,o.default)(a,u.POST_COMMENT,function(t,e){t.comment.list=[e].concat(t.comment.list)}),a);e.default={state:s,mutations:c}},50:function(t,e){},8:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.GLOBAL_LOADDING="GLOBAL_LOADDING",e.GLOBAL_PROGRESS="GLOBAL_PROGRESS",e.GLOBAL_SHOWMSG="GLOBAL_SHOWMSG",e.GLOBAL_HIDEMSG="GLOBAL_HIDEMSG",e.RECEIVE_TOPICS="RECEIVE_TOPICS",e.RECEIVE_ARTICLE="RECEIVE_ARTICLE",e.RECEIVE_COMMENT="RECEIVE_COMMENT",e.POST_COMMENT="POST_COMMENT",e.DELETE_ADMIN_TOPICS_PATH="DELETE_ADMIN_TOPICS_PATH",e.RECEIVE_ADMIN_TOPICS="RECEIVE_ADMIN_TOPICS",e.RECEIVE_ADMIN_ARTICLE="RECEIVE_ADMIN_ARTICLE",e.UPDATE_ADMIN_ARTICLE="UPDATE_ADMIN_ARTICLE",e.DELETE_ARTICLE="DELETE_ARTICLE",e.RECOVER_ARTICLE="RECOVER_ARTICLE"}},[240]);